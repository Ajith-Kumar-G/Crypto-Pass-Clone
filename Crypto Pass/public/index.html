<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="4.png">
  <title>CryptoPass</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <link rel="stylesheet" href="index.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orange-indigo.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
  <!-- update the version number as needed -->
  <script defer src="/__/firebase/9.6.1/firebase-app-compat.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/9.6.1/firebase-auth-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-database-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-firestore-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-functions-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-messaging-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-storage-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-analytics-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-remote-config-compat.js"></script>
  <script defer src="/__/firebase/9.6.1/firebase-performance-compat.js"></script>
  <!-- 
      initialize the SDK after all desired features are loaded, set useEmulator to false
      to avoid connecting the SDK to running emulators.
    -->
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark pad">
    <img class="logoImg" src="3.png">
    <a class="navbar-brand" href="#"> CryptoPass</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul>
      <ul class="navbar-nav"></ul>
      <ul class="nav">
        <li class="nav-item tab">
          <a class="nav-link" href="#">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="about.html">About Us</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="howto.html"> How To</a>
        </li></a>
        </li>
      </ul>
    </div>
  </nav>
  <div class='row'>
    <div class='col-md-6' id="LeftDEt">

      <div class="mdl-cell mdl-cell--5-col mdl-cell--5-col-tablet mdl-grid col_b">

        <!-- Container -->
        <div id="sign-in-card"
          class="mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-desktop">
          <div class="mdl-card__title mdl-color mdl-color-text--white">
            <h2 class="mdl-card__title-text">Generate QR code to connect</h2>
          </div>
          <div class="mdl-card__supporting-text mdl-color-text--grey-600">
            <div class="row">
              <div class="col-md-6">
                <p>Click here to get started</p>
                <button class="mdl-button mdl-js-button mdl-button--raised" id="sign-in-button">Get
                  Started</button>
              </div>
              <div class="col-md-6">
                <button class="mdl-button mdl-js-button mdl-button--raised" id="sign-out-button">Sign-out</button>
              </div>
            </div>
            </form>
          </div>
        </div>

        <!-- Container for the qr -->
        <div id="user-details-card"
          class="mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-desktop">
          <div class="mdl-card__title mdl-color mdl-color-text--white">
            <h2 class="mdl-card__title-text">Scan QR code here</h2>
          </div>
          <div class="mdl-card__supporting-text mdl-color-text--grey-600">
            <!-- Container where we'll display the user details -->
            <div class="user-details-container">
              <img id="qr_code" src="3.png"><span><button class="mdl-button mdl-js-button mdl-button--raised"
                  id="retbutton">Retrive
                </button></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="Peepeyes">
        <div class="hit-area">
          <div class="hitbox" id="a-1"></div>
          <div class="hitbox" id="a-2"></div>
          <div class="hitbox" id="a-3"></div>
          <div class="hitbox" id="a-4"></div>
          <div class="hitbox" id="a-5"></div>
          <div class="hitbox" id="b-1"></div>
          <div class="hitbox" id="b-2"></div>
          <div class="hitbox" id="b-3"></div>
          <div class="hitbox" id="b-4"></div>
          <div class="hitbox" id="b-5"></div>
          <div class="hitbox" id="c-1"></div>
          <div class="hitbox" id="c-2"></div>
          <div class="hitbox" id="c-3"></div>
          <div class="hitbox" id="c-4"></div>
          <div class="hitbox" id="c-5"></div>
          <div class="hitbox" id="d-1"></div>
          <div class="hitbox" id="d-2"></div>
          <div class="hitbox" id="d-3"></div>
          <div class="hitbox" id="d-4"></div>
          <div class="hitbox" id="d-5"></div>
          <div class="hitbox" id="e-1"></div>
          <div class="hitbox" id="e-2"></div>
          <div class="hitbox" id="e-3"></div>
          <div class="hitbox" id="e-4"></div>
          <div class="hitbox" id="e-5"></div>
          <div class="eye">
            <div class="pupil"></div>
          </div>
          <div class="eye">
            <div class="pupil"></div>
          </div>
          <div class="eyelid"></div>
          <div class="eyelid"></div>
        </div>
      </div>
      <div class="one-liner">
        Keep Your <br />privacy
        <span style="color: #18fbe0">safe</span> from<br />
        peeping
      </div>
      <div class="content">
        keep your passwords and contact safe from the public <br />
        eye with the help of our extension and app. Just a scan <br />
        and u are ready to GO!
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="index.js"></script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "",
      authDomain: "",
      databaseURL: "",
      projectId: "",
      storageBucket: "",
      messagingSenderId: "",
      appId: "",
      measurementId: ""
    };
    
    var db = firebase.firestore();
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    firebase.auth().onAuthStateChanged(function (user) {
      window.user = user;
    });

    var uid;
    var url;
    $("#sign-in-button").click(function () {
      anonAuth();
      $("#sign-in-button").css("visibility", "hidden");
      $("#sign-out-button").css("visibility", "visible");
      $('#retbutton').css("visibility", "visible");
    });
    $("#retbutton").click(function () {
      retrive();
    });
    function anonAuth() {

      console.log("Hello");
      firebase.auth().signInAnonymously().then(() => {
        // Signed in..
      })
        .catch((error) => {
          var errorCode = error.code;
          var errorMessage = error.message;
          // ...
        });
      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          // User is signed in, see docs for a list of available properties
          // https://firebase.google.com/docs/reference/js/firebase.User
          uid = user.uid;
          console.log("uid: ", uid);
          url = "https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=" + String(uid) + "&choe=UTF-8";
          document.getElementById("qr_code").src = url;
        } else {
          // User is signed out
          // ...
        }
      });

      document.querySelector('#sign-out-button').addEventListener('click', function () {
        console.log("Inside");
        const user = firebase.auth().currentUser;
        user.delete().then(() => {
          $('#retbutton').css("background-color", "wheat");
          $("#sign-in-button").css("visibility", "visible");
          $("#sign-out-button").css("visibility", "hidden");
          $('#retbutton').css("visibility", "hidden");
          document.getElementById("qr_code").src = "3.png";
          window.clipboardData.clearData("Shhhhh!");
        }).catch((error) => {
        });
      });
    }
    function retrive() {
      var docRef = db.collection("temp").doc(uid);

      docRef.get().then((doc) => {
        if (doc.exists) {
          console.log("Document data:", doc.data());
          let textarea = document.createElement('textarea');
          textarea.setAttribute('type', 'hidden');
          textarea.classList.add("hide");
          textarea.textContent = doc.data().Pass;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          textarea.remove();
          $('#retbutton').css("background-color", "green");
        } else {
          var RetBut = document.getElementById("retbutton");
          RetBut.classList.add("bounce");
          setTimeout(function () {
            RetBut.classList.remove("bounce");
          }, 1000);
          console.log("No such document!");
        }
      }).catch((error) => {
        console.log("Error getting document:", error);
      });
    }
  </script>
</body>

</html>